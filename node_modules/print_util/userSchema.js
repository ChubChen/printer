var mongoDBUtil = require("./MongoDBUtil.js");

function User(user){
	this.created = user.created;
	this.userName = user.userName;
	this.passWord = user.password;
	this.authority = user.authority;
}

User.prototype.save = function(cb){
	var user = {
		created: this.created,
		userName: this.userName,
		passWord: this.password,
		authority: this.authority
	};

	mongoDBUtil.db.collection('customer', function(err,collection){
		if(err){
			cb(err);
		}else{
			collection.ensureIndex({'userName':1});
			collection.insert(user, {safe:true}, function(err,doc){
				cb(err,doc);
			});
		}
	});
};

User.prototype.get = function(username,cb){
	mongoDBUtil.db.collection('customer', function(err,collection){
		if(err){
			cb(err);
		}else{
			collection.findOne({userName: username}, function(err,doc){
				cb(err,doc);
			});
		}
	});
};

module.exports = User;